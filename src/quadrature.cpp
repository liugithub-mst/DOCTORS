#include <cmath>

#include <string>
#include <iostream>

#include "quadrature.h"
#include "legendre.h"

Quadrature::Quadrature() : m_angles(0)
{

}

Quadrature::Quadrature(const int sn)
{
    loadSn(sn);
}

void Quadrature::loadSn(const int sn)
{
    m_angles = sn * (sn+2);  // Total discrete angles

    mu.resize(m_angles);
    eta.resize(m_angles);
    zi.resize(m_angles);
    wt.resize(m_angles);

    if(sn == 2)
    {
        mu[0] = -.577350f;
        mu[1] =  .577350f;
        mu[2] = -.577350f;
        mu[3] =  .577350f;
        for(int i = 4; i < 8; i++)
            mu[i] = mu[i-4];

        for(int i = 0; i < 4; i++)
            eta[i] = -.577350f;
        for(int i = 4; i < 8; i++)
            eta[i] = .577350f;

        for(int i = 0; i < 2; i++)
            zi[i] = -sqrt(1 - mu[i]*mu[i] - eta[i]*eta[i]);
        for(int i = 2; i < 4; i++)
            zi[i] = -zi[i-2];
        for(int i = 4; i < 8; i++)
            zi[i] = zi[i-4];

        for(int i = 0; i < 8; i++)
            wt[i] = 1.0 / 8.0;
    }
    else if(sn == 4)
    {
        mu[0] = -0.868890f;
        mu[1] = -0.350021f;
        mu[2] = -0.350021f;
        mu[3] =  0.350021f;
        mu[4] =  0.350021f;
        mu[5] =  0.868890f;
        for(int i = 6; i < 12; i++)
            mu[i] = mu[i-6];
        for(int i = 12; i < 24; i++)
            mu[i] = mu[i-12];

        eta[0] = -0.350021f;
        eta[1] = -0.350021f;
        eta[2] = -0.868890f;
        eta[3] = -0.868890f;
        eta[4] = -0.350021f;
        eta[5] = -0.350021f;
        for(int i = 6; i < 12; i++)
            eta[i] = eta[i-6];
        for(int i = 12; i < 24; i++)
            eta[i] = -eta[i-12];

        for(int i = 0; i < 6; i++)
            zi[i] = -sqrt(1 - mu[i]*mu[i] - eta[i]*eta[i]);
        for(int i = 6; i < 12; i++)
            zi[i] = -zi[i-6];
        for(int i = 12; i < 24; i++)
            zi[i] = zi[i-12];

        for(int i = 0; i < 24; i++)
            wt[i] = 1.0f / 24.0f;
    }
    else if(sn == 6)
    {
        mu[0] = -0.926181f;
        mu[1] = -0.681508f;
        mu[2] = -0.681508f;
        mu[3] = -0.266636f;
        mu[4] = -0.266636f;
        mu[5] = -0.266636f;
        mu[6] =  0.266636f;
        mu[7] =  0.266636f;
        mu[8] =  0.266636f;
        mu[9] =  0.681508f;
        mu[10] = 0.681508f;
        mu[11] = 0.926181f;
        for(int i = 12; i < 24; i++)
            mu[i] = mu[i-12];
        for(int i = 24; i < 48; i++)
            mu[i] = mu[i-24];

        eta[0] = -0.266636f;
        eta[1] = -0.266636f;
        eta[2] = -0.681508f;
        eta[3] = -0.266636f;
        eta[4] = -0.681508f;
        eta[5] = -0.926181f;
        eta[6] = -0.926181f;
        eta[7] = -0.681508f;
        eta[8] = -0.266636f;
        eta[9] = -0.681508f;
        eta[10] = -0.266636f;
        eta[11] = -0.266636f;
        for(int i = 12; i < 24; i++)
            eta[i] = eta[i-12];
        for(int i = 24; i < 48; i++)
            eta[i] = -eta[i-24];

        for(int i = 0; i < 12; i++)
            zi[i] = -sqrt(1 - mu[i]*mu[i] - eta[i]*eta[i]);
        for(int i = 12; i < 24; i++)
            zi[i] = -zi[i-12];
        for(int i = 24; i < 48; i++)
            zi[i] = zi[i-24];

        wt[0] = 0.176126f/8.0f;
        wt[1] = 0.157207f/8.0f;
        wt[2] = 0.157207f/8.0f;
        wt[3] = 0.176126f/8.0f;
        wt[4] = 0.157207f/8.0f;
        wt[5] = 0.176126f/8.0f;
        wt[6] = 0.176126f/8.0f;
        wt[7] = 0.157207f/8.0f;
        wt[8] = 0.176126f/8.0f;
        wt[9] = 0.157207f/8.0f;
        wt[10] = 0.157207f/8.0f;
        wt[11] = 0.176126f/8.0f;
        for(int i = 12; i < 24; i++)
            wt[i] = wt[i-12];
        for(int i = 24; i < 48; i++)
            wt[i] = wt[i-24];
    }
    else if(sn == 8)
    {
                mu[0] = -0.951190f;
        mu[1] = -0.786796f;
        mu[2] = -0.786796f;
        mu[3] = -0.577350f;
        mu[4] = -0.577350f;
        mu[5] = -0.577350f;
        mu[6] = -0.218218f;
        mu[7] = -0.218218f;
        mu[8] = -0.218218f;
        mu[9] = -0.218218f;
        mu[10] = 0.218218f;
        mu[11] = 0.218218f;
        mu[12] = 0.218218f;
        mu[13] = 0.218218f;
        mu[14] = 0.577350f;
        mu[15] = 0.577350f;
        mu[16] = 0.577350f;
        mu[17] = 0.786796f;
        mu[18] = 0.786796f;
        mu[19] = 0.951190f;

        for(int i = 20; i < 40; i++)
            mu[i] = mu[i-20];
        for(int i = 40; i < 80; i++)
            mu[i] = mu[i-40];

        eta[0] = -0.218218f;
        eta[1] = -0.218218f;
        eta[2] = -0.577350f;
        eta[3] = -0.218218f;
        eta[4] = -0.577350f;
        eta[5] = -0.786796f;
        eta[6] = -0.218218f;
        eta[7] = -0.577350f;
        eta[8] = -0.786796f;
        eta[9] = -0.951190f;
        eta[10] = -0.951190f;
        eta[11] = -0.786796f;
        eta[12] = -0.577350f;
        eta[13] = -0.218218f;
        eta[14] = -0.786796f;
        eta[15] = -0.577350f;
        eta[16] = -0.218218f;
        eta[17] = -0.577350f;
        eta[18] = -0.218218f;
        eta[19] = -0.218218f;

        for(int i = 20; i < 40; i++)
            eta[i] = eta[i-20];
        for(int i = 40; i < 80; i++)
            eta[i] = -eta[i-40];

        for(int i = 0; i < 20; i++)
            zi[i] = -sqrt(1 - mu[i]*mu[i] - eta[i]*eta[i]);
        for(int i = 20; i < 40; i++)
            zi[i] = -zi[i-20];
        for(int i = 40; i < 80; i++)
            zi[i] = zi[i-40];

        wt[0] = 0.1209877f/8.0f;
        wt[1] = 0.0907407f/8.0f;
        wt[2] = 0.0907407f/8.0f;
        wt[3] = 0.0907407f/8.0f;
        wt[4] = 0.0925927f/8.0f;
        wt[5] = 0.0907407f/8.0f;
        wt[6] = 0.1209877f/8.0f;
        wt[7] = 0.0907407f/8.0f;
        wt[8] = 0.0907407f/8.0f;
        wt[9] = 0.1209877f/8.0f;
        wt[10] = 0.1209877f/8.0f;
        wt[11] = 0.0907407f/8.0f;
        wt[12] = 0.0907407f/8.0f;
        wt[13] = 0.1209877f/8.0f;
        wt[14] = 0.0907407f/8.0f;
        wt[15] = 0.0925927f/8.0f;
        wt[16] = 0.0907407f/8.0f;
        wt[17] = 0.0907407f/8.0f;
        wt[18] = 0.0907407f/8.0f;
        wt[19] = 0.1209877f/8.0f;

        for(int i = 20; i < 40; i++)
            wt[i] = wt[i-20];
        for(int i = 40; i < 80; i++)
            wt[i] = wt[i-40];
    }
    else if(sn == 10)   //Fixme! add one more quad
    {
        mu[0] = -0.963491f;
        mu[1] = -0.839760f;
        mu[2] = -0.839760f;
        mu[3] = -0.694319f;
        mu[4] = -0.694319f;
        mu[5] = -0.694319f;
        mu[6] = -0.508882f;
        mu[7] = -0.508882f;
        mu[8] = -0.508882f;
        mu[9] = -0.508882f;
        mu[10] = -0.189321f;
        mu[11] = -0.189321f;
        mu[12] = -0.189321f;
        mu[13] = -0.189321f;
        mu[14] = -0.189321f;
        mu[15] = 0.189321f;
        mu[16] = 0.189321f;
        mu[17] = 0.189321f;
        mu[18] = 0.189321f;
        mu[19] = 0.189321f;
        mu[20] = 0.508882f;
        mu[21] = 0.508882f;
        mu[22] = 0.508882f;
        mu[23] = 0.508882f;
        mu[24] = 0.694319f;
        mu[25] = 0.694319f;
        mu[26] = 0.694319f;
        mu[27] = 0.839760f;
        mu[28] = 0.839760f;
        mu[29] = 0.963491f;

        for(int i = 30; i < 60; i++)
            mu[i] = mu[i-30];
        for(int i = 60; i < 120; i++)
            mu[i] = mu[i-60];

        eta[0] = -0.189321f;
        eta[1] = -0.189321f;
        eta[2] = -0.508882f;
        eta[3] = -0.189321f;
        eta[4] = -0.508882f;
        eta[5] = -0.694319f;
        eta[6] = -0.189321f;
        eta[7] = -0.508882f;
        eta[8] = -0.694319f;
        eta[9] = -0.839760f;
        eta[10] = -0.189321f;
        eta[11] = -0.508882f;
        eta[12] = -0.694319f;
        eta[13] = -0.839760f;
        eta[14] = -0.963491f;
        eta[15] = -0.963491f;
        eta[16] = -0.839760;
        eta[17] = -0.694319f;
        eta[18] = -0.508882f;
        eta[19] = -0.189321f;
        eta[20] = -0.839760f;
        eta[21] = -0.694319f;
        eta[22] = -0.508882f;
        eta[23] = -0.189321f;
        eta[24] = -0.694319f;
        eta[25] = -0.508882f;
        eta[26] = -0.189321f;
        eta[27] = -0.508882f;
        eta[28] = -0.189321f;
        eta[29] = -0.189321f;

        for(int i = 30; i < 60; i++)
            eta[i] = eta[i-30];
        for(int i = 60; i < 120; i++)
            eta[i] = -eta[i-60];

        for(int i = 0; i < 30; i++)
            zi[i] = -sqrt(1 - mu[i]*mu[i] - eta[i]*eta[i]);
        for(int i = 30; i < 60; i++)
            zi[i] = -zi[i-30];
        for(int i = 60; i < 120; i++)
            zi[i] = zi[i-60];

        wt[0] = 0.0893031f/8.0f;
        wt[1] = 0.0725292f/8.0f;
        wt[2] = 0.0725292f/8.0f;
        wt[3] = 0.0450438f/8.0f;
        wt[4] = 0.0539281f/8.0f;
        wt[5] = 0.0450438f/8.0f;
        wt[6] = 0.0725292f/8.0f;
        wt[7] = 0.0539281f/8.0f;
        wt[8] = 0.0539281f/8.0f;
        wt[9] = 0.0725292f/8.0f;
        wt[10] = 0.0893031f/8.0f;
        wt[11] = 0.0725292f/8.0f;
        wt[12] = 0.0450438f/8.0f;
        wt[13] = 0.0725292f/8.0f;
        wt[14] = 0.0893031f/8.0f;
        wt[15] = 0.0893031f/8.0f;
        wt[16] = 0.0725292f/8.0f;
        wt[17] = 0.0450438f/8.0f;
        wt[18] = 0.0725292f/8.0f;
        wt[19] = 0.0893031f/8.0f;
        wt[20] = 0.0725292f/8.0f;
        wt[21] = 0.0539281f/8.0f;
        wt[22] = 0.0539281f/8.0f;
        wt[23] = 0.0725292f/8.0f;
        wt[24] = 0.0450438f/8.0f;
        wt[25] = 0.0539281f/8.0f;
        wt[26] = 0.0450438f/8.0f;
        wt[27] = 0.0725292f/8.0f;
        wt[28] = 0.0725292f/8.0f;
        wt[29] = 0.0893031f/8.0f;

        for(int i = 30; i < 60; i++)
            wt[i] = wt[i-30];
        for(int i = 60; i < 120; i++)
            wt[i] = wt[i-60];
    }
    else if(sn == 12)   //Fixme! add one more quad
    {
        mu[0] = -0.971638f;
        mu[1] = -0.872271f;
        mu[2] = -0.872271f;
        mu[3] = -0.760021f;
        mu[4] = -0.760021f;
        mu[5] = -0.760021f;
        mu[6] = -0.628019f;
        mu[7] = -0.628019f;
        mu[8] = -0.628019f;
        mu[9] = -0.628019f;
        mu[10] = -0.459548f;
        mu[11] = -0.459548f;
        mu[12] = -0.459548f;
        mu[13] = -0.459548f;
        mu[14] = -0.459548f;
        mu[15] = -0.167213f;
        mu[16] = -0.167213f;
        mu[17] = -0.167213f;
        mu[18] = -0.167213f;
        mu[19] = -0.167213f;
        mu[20] = -0.167213f;
        mu[21] = 0.167213f;
        mu[22] = 0.167213f;
        mu[23] = 0.167213f;
        mu[24] = 0.167213f;
        mu[25] = 0.167213f;
        mu[26] = 0.167213f;
        mu[27] = 0.459548f;
        mu[28] = 0.459548f;
        mu[29] = 0.459548f;
        mu[30] = 0.459548f;
        mu[31] = 0.459548f;
        mu[32] = 0.628019f;
        mu[33] = 0.628019f;
        mu[34] = 0.628019f;
        mu[35] = 0.628019f;
        mu[36] = 0.760021f;
        mu[37] = 0.760021f;
        mu[38] = 0.760021f;
        mu[39] = 0.872271f;
        mu[40] = 0.872271f;
        mu[41] = 0.971638f;

        for(int i = 42; i < 84; i++)
            mu[i] = mu[i-42];
        for(int i = 84; i < 168; i++)
            mu[i] = mu[i-84];

        eta[0] = -0.167213f;
        eta[1] = -0.167213f;
        eta[2] = -0.459548f;
        eta[3] = -0.167213f;
        eta[4] = -0.459548f;
        eta[5] = -0.628019f;
        eta[6] = -0.167213f;
        eta[7] = -0.459548f;
        eta[8] = -0.628019f;
        eta[9] = -0.760021f;
        eta[10] = -0.167213f;
        eta[11] = -0.459548f;
        eta[12] = -0.628019f;
        eta[13] = -0.760021f;
        eta[14] = -0.872271f;
        eta[15] = -0.167213f;
        eta[16] = -0.459548f;
        eta[17] = -0.628019f;
        eta[18] = -0.760021f;
        eta[19] = -0.872271f;
        eta[20] = -0.971638f;
        eta[21] = -0.971638f;
        eta[22] = -0.872271f;
        eta[23] = -0.760021f;
        eta[24] = -0.628019f;
        eta[25] = -0.459548f;
        eta[26] = -0.167213f;
        eta[27] = -0.872271f;
        eta[28] = -0.760021f;
        eta[29] = -0.628019f;
        eta[30] = -0.459548f;
        eta[31] = -0.167213f;
        eta[32] = -0.760021f;
        eta[33] = -0.628019f;
        eta[34] = -0.459548f;
        eta[35] = -0.167213f;
        eta[36] = -0.628019f;
        eta[37] = -0.459548f;
        eta[38] = -0.167213f;
        eta[39] = -0.459548f;
        eta[40] = -0.167213f;
        eta[41] = -0.167213f;

        for(int i = 42; i < 84; i++)
            eta[i] = eta[i-42];
        for(int i = 84; i < 168; i++)
            eta[i] = -eta[i-84];

        for(int i = 0; i < 42; i++)
            zi[i] = -sqrt(1 - mu[i]*mu[i] - eta[i]*eta[i]);
        for(int i = 42; i < 84; i++)
            zi[i] = -zi[i-42];
        for(int i = 84; i < 168; i++)
            zi[i] = zi[i-84];

        wt[0] = 0.0707626f/8.0f;
        wt[1] = 0.0558811f/8.0f;
        wt[2] = 0.0558811f/8.0f;
        wt[3] = 0.0373377f/8.0f;
        wt[4] = 0.0502819f/8.0f;
        wt[5] = 0.0373377f/8.0f;
        wt[6] = 0.0373377f/8.0f;
        wt[7] = 0.0258513f/8.0f;
        wt[8] = 0.0258513f/8.0f;
        wt[9] = 0.0373377f/8.0f;
        wt[10] = 0.0558811f/8.0f;
        wt[11] = 0.0502819f/8.0f;
        wt[12] = 0.0258513f/8.0f;
        wt[13] = 0.0502819f/8.0f;
        wt[14] = 0.0558811f/8.0f;
        wt[15] = 0.0707626f/8.0f;
        wt[16] = 0.0558811f/8.0f;
        wt[17] = 0.0373377f/8.0f;
        wt[18] = 0.0373377f/8.0f;
        wt[19] = 0.0558811f/8.0f;
        wt[20] = 0.0707626f/8.0f;
        wt[21] = 0.0707626f/8.0f;
        wt[22] = 0.0558811f/8.0f;
        wt[23] = 0.0373377f/8.0f;
        wt[24] = 0.0373377f/8.0f;
        wt[25] = 0.0558811f/8.0f;
        wt[26] = 0.0707626f/8.0f;
        wt[27] = 0.0558811f/8.0f;
        wt[28] = 0.0502819f/8.0f;
        wt[29] = 0.0258513f/8.0f;
        wt[30] = 0.0502819f/8.0f;
        wt[31] = 0.0558811f/8.0f;
        wt[32] = 0.0373377f/8.0f;
        wt[33] = 0.0258513f/8.0f;
        wt[34] = 0.0258513f/8.0f;
        wt[35] = 0.0373377f/8.0f;
        wt[36] = 0.0373377f/8.0f;
        wt[37] = 0.0502819f/8.0f;
        wt[38] = 0.0373377f/8.0f;
        wt[39] = 0.0558811f/8.0f;
        wt[40] = 0.0558811f/8.0f;
        wt[41] = 0.0707626f/8.0f;

        for(int i = 42; i < 84; i++)
            wt[i] = wt[i-42];
        for(int i = 84; i < 168; i++)
            wt[i] = wt[i-84];
    }
    else if(sn == 14)   //Fixme! add one more quad
    {
        mu[0] = -0.976627f;
        mu[1] = -0.893691f;
        mu[2] = -0.893691f;
        mu[3] = -0.802226f;
        mu[4] = -0.802226f;
        mu[5] = -0.802226f;
        mu[6] = -0.698892f;
        mu[7] = -0.698892f;
        mu[8] = -0.698892f;
        mu[9] = -0.698892f;
        mu[10] = -0.577350f;
        mu[11] = -0.577350f;
        mu[12] = -0.577350f;
        mu[13] = -0.577350f;
        mu[14] = -0.577350f;
        mu[15] = -0.422157f;
        mu[16] = -0.422157f;
        mu[17] = -0.422157f;
        mu[18] = -0.422157f;
        mu[19] = -0.422157f;
        mu[20] = -0.422157f;
        mu[21] = -0.151986f;
        mu[22] = -0.151986f;
        mu[23] = -0.151986f;
        mu[24] = -0.151986f;
        mu[25] = -0.151986f;
        mu[26] = -0.151986f;
        mu[27] = -0.151986f;
        mu[28] = 0.151986f;
        mu[29] = 0.151986f;
        mu[30] = 0.151986f;
        mu[31] = 0.151986f;
        mu[32] = 0.151986f;
        mu[33] = 0.151986f;
        mu[34] = 0.151986f;
        mu[35] = 0.422157f;
        mu[36] = 0.422157f;
        mu[37] = 0.422157f;
        mu[38] = 0.422157f;
        mu[39] = 0.422157f;
        mu[40] = 0.422157f;
        mu[41] = 0.577350f;
        mu[42] = 0.577350f;
        mu[43] = 0.577350f;
        mu[44] = 0.577350f;
        mu[45] = 0.577350f;
        mu[46] = 0.698892f;
        mu[47] = 0.698892f;
        mu[48] = 0.698892f;
        mu[49] = 0.698892f;
        mu[50] = 0.802226f;
        mu[51] = 0.802226f;
        mu[52] = 0.802226f;
        mu[53] = 0.893691f;
        mu[54] = 0.893691f;
        mu[55] = 0.976627f;

        for(int i = 56; i < 112; i++)
            mu[i] = mu[i-56];
        for(int i = 112; i < 224; i++)
            mu[i] = mu[i-112];

        eta[0] = -0.151986f;
        eta[1] = -0.151986f;
        eta[2] = -0.422157f;
        eta[3] = -0.151986f;
        eta[4] = -0.422157f;
        eta[5] = -0.577350f;
        eta[6] = -0.151986f;
        eta[7] = -0.422157f;
        eta[8] = -0.577350f;
        eta[9] = -0.698892f;
        eta[10] = -0.151986f;
        eta[11] = -0.422157f;
        eta[12] = -0.577350f;
        eta[13] = -0.698892f;
        eta[14] = -0.802226f;
        eta[15] = -0.151986f;
        eta[16] = -0.422157f;
        eta[17] = -0.577350f;
        eta[18] = -0.698892f;
        eta[19] = -0.802226f;
        eta[20] = -0.893691f;
        eta[21] = -0.151986f;
        eta[22] = -0.422157f;
        eta[23] = -0.577350f;
        eta[24] = -0.698892f;
        eta[25] = -0.802226f;
        eta[26] = -0.893691f;
        eta[27] = -0.976627f;
        eta[28] = -0.976627f;
        eta[29] = -0.893691f;
        eta[30] = -0.802226f;
        eta[31] = -0.698892f;
        eta[32] = -0.577350f;
        eta[33] = -0.422157f;
        eta[34] = -0.151986f;
        eta[35] = -0.893691f;
        eta[36] = -0.802226f;
        eta[37] = -0.698892f;
        eta[38] = -0.577350f;
        eta[39] = -0.422157f;
        eta[40] = -0.151986f;
        eta[41] = -0.802226f;
        eta[42] = -0.698892f;
        eta[43] = -0.577350f;
        eta[44] = -0.422157f;
        eta[45] = -0.151986f;
        eta[46] = -0.698892f;
        eta[47] = -0.577350f;
        eta[48] = -0.422157f;
        eta[49] = -0.151986f;
        eta[50] = -0.577350f;
        eta[51] = -0.422157f;
        eta[52] = -0.151986f;
        eta[53] = -0.422157f;
        eta[54] = -0.151986f;
        eta[55] = -0.151986f;

        for(int i = 56; i < 112; i++)
            eta[i] = eta[i-56];
        for(int i = 112; i < 224; i++)
            eta[i] = -eta[i-112];

        for(int i = 0; i < 56; i++)
            zi[i] = -sqrt(1 - mu[i]*mu[i] - eta[i]*eta[i]);
        for(int i = 56; i < 112; i++)
            zi[i] = -zi[i-56];
        for(int i = 112; i < 224; i++)
            zi[i] = zi[i-112];

        wt[0] = 0.0579970f/8.0f;
        wt[1] = 0.0489008f/8.0f;
        wt[2] = 0.0489008f/8.0f;
        wt[3] = 0.0221497f/8.0f;
        wt[4] = 0.0393867f/8.0f;
        wt[5] = 0.0221497f/8.0f;
        wt[6] = 0.0407009f/8.0f;
        wt[7] = 0.0245518f/8.0f;
        wt[8] = 0.0245518f/8.0f;
        wt[9] = 0.0407009f/8.0f;
        wt[10] = 0.0221497f/8.0f;
        wt[11] = 0.0245518f/8.0f;
        wt[12] = 0.0121325f/8.0f;
        wt[13] = 0.0245518f/8.0f;
        wt[14] = 0.0221497f/8.0f;
        wt[15] = 0.0489008f/8.0f;
        wt[16] = 0.0393867f/8.0f;
        wt[17] = 0.0245518f/8.0f;
        wt[18] = 0.0245518f/8.0f;
        wt[19] = 0.0393867f/8.0f;
        wt[20] = 0.0489008f/8.0f;
        wt[21] = 0.0579970f/8.0f;
        wt[22] = 0.0489008f/8.0f;
        wt[23] = 0.0221497f/8.0f;
        wt[24] = 0.0407009f/8.0f;
        wt[25] = 0.0221497f/8.0f;
        wt[26] = 0.0489008f/8.0f;
        wt[27] = 0.0579970f/8.0f;
        wt[28] = 0.0579970f/8.0f;
        wt[29] = 0.0489008f/8.0f;
        wt[30] = 0.0221497f/8.0f;
        wt[31] = 0.0407009f/8.0f;
        wt[32] = 0.0221497f/8.0f;
        wt[33] = 0.0489008f/8.0f;
        wt[34] = 0.0579970f/8.0f;
        wt[35] = 0.0489008f/8.0f;
        wt[36] = 0.0393867f/8.0f;
        wt[37] = 0.0245518f/8.0f;
        wt[38] = 0.0245518f/8.0f;
        wt[39] = 0.0393867f/8.0f;
        wt[40] = 0.0489008f/8.0f;
        wt[41] = 0.0221497f/8.0f;
        wt[42] = 0.0245518f/8.0f;
        wt[43] = 0.0121325f/8.0f;
        wt[44] = 0.0245518f/8.0f;
        wt[45] = 0.0221497f/8.0f;
        wt[46] = 0.0407009f/8.0f;
        wt[47] = 0.0245518f/8.0f;
        wt[48] = 0.0245518f/8.0f;
        wt[49] = 0.0407009f/8.0f;
        wt[50] = 0.0221497f/8.0f;
        wt[51] = 0.0393867f/8.0f;
        wt[52] = 0.0221497f/8.0f;
        wt[53] = 0.0489008f/8.0f;
        wt[54] = 0.0489008f/8.0f;
        wt[55] = 0.0579970f/8.0f;

        for(int i = 56; i < 112; i++)
            wt[i] = wt[i-56];
        for(int i = 112; i < 224; i++)
            wt[i] = wt[i-112];
    }
    else if(sn == 16)   //Fixme! add one more quad
    {
        mu[0] = -0.980501f;
        mu[1] = -0.909286f;
        mu[2] = -0.909286f;
        mu[3] = -0.831997f;
        mu[4] = -0.831997f;
        mu[5] = -0.831997f;
        mu[6] = -0.746751f;
        mu[7] = -0.746751f;
        mu[8] = -0.746751f;
        mu[9] = -0.746751f;
        mu[10] = -0.650427f;
        mu[11] = -0.650427f;
        mu[12] = -0.650427f;
        mu[13] = -0.650427f;
        mu[14] = -0.650427f;
        mu[15] = -0.537097f;
        mu[16] = -0.537097f;
        mu[17] = -0.537097f;
        mu[18] = -0.537097f;
        mu[19] = -0.537097f;
        mu[20] = -0.537097f;
        mu[21] = -0.392289f;
        mu[22] = -0.392289f;
        mu[23] = -0.392289f;
        mu[24] = -0.392289f;
        mu[25] = -0.392289f;
        mu[26] = -0.392289f;
        mu[27] = -0.392289f;
        mu[28] = -0.138957f;
        mu[29] = -0.138957f;
        mu[30] = -0.138957f;
        mu[31] = -0.138957f;
        mu[32] = -0.138957f;
        mu[33] = -0.138957f;
        mu[34] = -0.138957f;
        mu[35] = -0.138957f;
        mu[36] = 0.138957f;
        mu[37] = 0.138957f;
        mu[38] = 0.138957f;
        mu[39] = 0.138957f;
        mu[40] = 0.138957f;
        mu[41] = 0.138957f;
        mu[42] = 0.138957f;
        mu[43] = 0.138957f;
        mu[44] = 0.392289f;
        mu[45] = 0.392289f;
        mu[46] = 0.392289f;
        mu[47] = 0.392289f;
        mu[48] = 0.392289f;
        mu[49] = 0.392289f;
        mu[50] = 0.392289f;
        mu[51] = 0.537097f;
        mu[52] = 0.537097f;
        mu[53] = 0.537097f;
        mu[54] = 0.537097f;
        mu[55] = 0.537097f;
        mu[56] = 0.537097f;
        mu[57] = 0.650427f;
        mu[58] = 0.650427f;
        mu[59] = 0.650427f;
        mu[60] = 0.650427f;
        mu[61] = 0.650427f;
        mu[62] = 0.746751f;
        mu[63] = 0.746751f;
        mu[64] = 0.746751f;
        mu[65] = 0.746751f;
        mu[66] = 0.831997f;
        mu[67] = 0.831997f;
        mu[68] = 0.831997f;
        mu[69] = 0.909286f;
        mu[70] = 0.909286f;
        mu[71] = 0.980501f;

        for(int i = 72; i < 144; i++)
            mu[i] = mu[i-72];
        for(int i = 144; i < 288; i++)
            mu[i] = mu[i-144];

        eta[0] = -0.138957f;
        eta[1] = -0.138957f;
        eta[2] = -0.392289f;
        eta[3] = -0.138957f;
        eta[4] = -0.392289f;
        eta[5] = -0.537097f;
        eta[6] = -0.138957f;
        eta[7] = -0.392289f;
        eta[8] = -0.577350f;
        eta[9] = -0.650427f;
        eta[10] = -0.138957f;
        eta[11] = -0.392289f;
        eta[12] = -0.537097f;
        eta[13] = -0.650427f;
        eta[14] = -0.746751f;
        eta[15] = -0.138957f;
        eta[16] = -0.392289f;
        eta[17] = -0.537097f;
        eta[18] = -0.650427f;
        eta[19] = -0.746751f;
        eta[20] = -0.831997f;
        eta[21] = -0.138957f;
        eta[22] = -0.392289f;
        eta[23] = -0.537097f;
        eta[24] = -0.650427f;
        eta[25] = -0.746751f;
        eta[26] = -0.831997f;
        eta[27] = -0.909286f;
        eta[28] = -0.138957f;
        eta[29] = -0.392289f;
        eta[30] = -0.537097f;
        eta[31] = -0.650427f;
        eta[32] = -0.746751f;
        eta[33] = -0.831997f;
        eta[34] = -0.909286f;
        eta[35] = -0.980501f;
        eta[36] = -0.980501f;
        eta[37] = -0.909286f;
        eta[38] = -0.831997f;
        eta[39] = -0.746751f;
        eta[40] = -0.650427f;
        eta[41] = -0.537097f;
        eta[42] = -0.392289f;
        eta[43] = -0.138957f;
        eta[44] = -0.909286f;
        eta[45] = -0.831997f;
        eta[46] = -0.746751f;
        eta[47] = -0.650427f;
        eta[48] = -0.537097f;
        eta[49] = -0.392289f;
        eta[50] = -0.138957f;
        eta[51] = -0.831997f;
        eta[52] = -0.746751f;
        eta[53] = -0.650427f;
        eta[54] = -0.537097f;
        eta[55] = -0.392289f;
        eta[56] = -0.138957f;
        eta[57] = -0.746751f;
        eta[58] = -0.650427f;
        eta[59] = -0.537097f;
        eta[60] = -0.392289f;
        eta[61] = -0.138957f;
        eta[62] = -0.650427f;
        eta[63] = -0.537097f;
        eta[64] = -0.392289f;
        eta[65] = -0.138957f;
        eta[66] = -0.537097f;
        eta[67] = -0.392289f;
        eta[68] = -0.138957f;
        eta[69] = -0.392289f;
        eta[70] = -0.138957f;
        eta[71] = -0.138957f;

        for(int i = 72; i < 144; i++)
            eta[i] = eta[i-72];
        for(int i = 144; i < 288; i++)
            eta[i] = -eta[i-144];

        for(int i = 0; i < 72; i++)
            zi[i] = -sqrt(1 - mu[i]*mu[i] - eta[i]*eta[i]);
        for(int i = 72; i < 144; i++)
            zi[i] = -zi[i-72];
        for(int i = 144; i < 288; i++)
            zi[i] = zi[i-144];

        wt[0] = 0.0489872f/8.0f;
        wt[1] = 0.0413296f/8.0f;
        wt[2] = 0.0413296f/8.0f;
        wt[3] = 0.0224476f/8.0f;
        wt[4] = 0.0336186f/8.0f;
        wt[5] = 0.0224476f/8.0f;
        wt[6] = 0.0244057f/8.0f;
        wt[7] = 0.0156739f/8.0f;
        wt[8] = 0.0156739f/8.0f;
        wt[9] = 0.0244057f/8.0f;
        wt[10] = 0.0244057f/8.0f;
        wt[11] = 0.0369257f/8.0f;
        wt[12] = 0.0060882f/8.0f;
        wt[13] = 0.0369257f/8.0f;
        wt[14] = 0.0244057f/8.0f;
        wt[15] = 0.0224476f/8.0f;
        wt[16] = 0.0156739f/8.0f;
        wt[17] = 0.0060882f/8.0f;
        wt[18] = 0.0060882f/8.0f;
        wt[19] = 0.0156739f/8.0f;
        wt[20] = 0.0224476f/8.0f;
        wt[21] = 0.0413296f/8.0f;
        wt[22] = 0.0336186f/8.0f;
        wt[23] = 0.0156739f/8.0f;
        wt[24] = 0.0369257f/8.0f;
        wt[25] = 0.0156739f/8.0f;
        wt[26] = 0.0336186f/8.0f;
        wt[27] = 0.0413296f/8.0f;
        wt[28] = 0.0489872f/8.0f;
        wt[29] = 0.0413296f/8.0f;
        wt[30] = 0.0224476f/8.0f;
        wt[31] = 0.0244057f/8.0f;
        wt[32] = 0.0244057f/8.0f;
        wt[33] = 0.0224476f/8.0f;
        wt[34] = 0.0413296f/8.0f;
        wt[35] = 0.0489872f/8.0f;
        wt[36] = 0.0489872f/8.0f;
        wt[37] = 0.0413296f/8.0f;
        wt[38] = 0.0224476f/8.0f;
        wt[39] = 0.0244057f/8.0f;
        wt[40] = 0.0244057f/8.0f;
        wt[41] = 0.0224476f/8.0f;
        wt[42] = 0.0413296f/8.0f;
        wt[43] = 0.0489872f/8.0f;
        wt[44] = 0.0413296f/8.0f;
        wt[45] = 0.0336186f/8.0f;
        wt[46] = 0.0156739f/8.0f;
        wt[47] = 0.0369257f/8.0f;
        wt[48] = 0.0156739f/8.0f;
        wt[49] = 0.0336186f/8.0f;
        wt[50] = 0.0413296f/8.0f;
        wt[51] = 0.0224476f/8.0f;
        wt[52] = 0.0156739f/8.0f;
        wt[53] = 0.0060882f/8.0f;
        wt[54] = 0.0060882f/8.0f;
        wt[55] = 0.0156739f/8.0f;
        wt[56] = 0.0224476f/8.0f;
        wt[57] = 0.0244057f/8.0f;
        wt[58] = 0.0369257f/8.0f;
        wt[59] = 0.0060882f/8.0f;
        wt[60] = 0.0369257f/8.0f;
        wt[61] = 0.0244057f/8.0f;
        wt[62] = 0.0244057f/8.0f;
        wt[63] = 0.0156739f/8.0f;
        wt[64] = 0.0156739f/8.0f;
        wt[65] = 0.0244057f/8.0f;
        wt[66] = 0.0224476f/8.0f;
        wt[67] = 0.0336186f/8.0f;
        wt[68] = 0.0224476f/8.0f;
        wt[69] = 0.0413296f/8.0f;
        wt[70] = 0.0413296f/8.0f;
        wt[71] = 0.0489872f/8.0f;

        for(int i = 72; i < 144; i++)
            wt[i] = wt[i-72];
        for(int i = 144; i < 288; i++)
            wt[i] = wt[i-144];
    }
    else if(sn == 18)   //Fixme! add one more quad
    {
        mu[0] = -0.983128f;
        mu[1] = -0.920768f;
        mu[2] = -0.920768f;
        mu[3] = -0.853866f;
        mu[4] = -0.853866f;
        mu[5] = -0.853866f;
        mu[6] = -0.781256f;
        mu[7] = -0.781256f;
        mu[8] = -0.781256f;
        mu[9] = -0.781256f;
        mu[10] = -0.701167f;
        mu[11] = -0.701167f;
        mu[12] = -0.701167f;
        mu[13] = -0.701167f;
        mu[14] = -0.701167f;
        mu[15] = -0.610663f;
        mu[16] = -0.610663f;
        mu[17] = -0.610663f;
        mu[18] = -0.610663f;
        mu[19] = -0.610663f;
        mu[20] = -0.610663f;
        mu[21] = -0.504165f;
        mu[22] = -0.504165f;
        mu[23] = -0.504165f;
        mu[24] = -0.504165f;
        mu[25] = -0.504165f;
        mu[26] = -0.504165f;
        mu[27] = -0.504165f;
        mu[28] = -0.368044f;
        mu[29] = -0.368044f;
        mu[30] = -0.368044f;
        mu[31] = -0.368044f;
        mu[32] = -0.368044f;
        mu[33] = -0.368044f;
        mu[34] = -0.368044f;
        mu[35] = -0.368044f;
        mu[36] = -0.129345f;
        mu[37] = -0.129345f;
        mu[38] = -0.129345f;
        mu[39] = -0.129345f;
        mu[40] = -0.129345f;
        mu[41] = -0.129345f;
        mu[42] = -0.129345f;
        mu[43] = -0.129345f;
        mu[44] = -0.129345f;
        mu[45] = 0.129345f;
        mu[46] = 0.129345f;
        mu[47] = 0.129345f;
        mu[48] = 0.129345f;
        mu[49] = 0.129345f;
        mu[50] = 0.129345f;
        mu[51] = 0.129345f;
        mu[52] = 0.129345f;
        mu[53] = 0.129345f;
        mu[54] = 0.368044f;
        mu[55] = 0.368044f;
        mu[56] = 0.368044f;
        mu[57] = 0.368044f;
        mu[58] = 0.368044f;
        mu[59] = 0.368044f;
        mu[60] = 0.368044f;
        mu[61] = 0.368044f;
        mu[62] = 0.504165f;
        mu[63] = 0.504165f;
        mu[64] = 0.504165f;
        mu[65] = 0.504165f;
        mu[66] = 0.504165f;
        mu[67] = 0.504165f;
        mu[68] = 0.504165f;
        mu[69] = 0.610663f;
        mu[70] = 0.610663f;
        mu[71] = 0.610663f;
        mu[72] = 0.610663f;
        mu[73] = 0.610663f;
        mu[74] = 0.610663f;
        mu[75] = 0.701167f;
        mu[76] = 0.701167f;
        mu[77] = 0.701167f;
        mu[78] = 0.701167f;
        mu[79] = 0.701167f;
        mu[80] = 0.781256f;
        mu[81] = 0.781256f;
        mu[82] = 0.781256f;
        mu[83] = 0.781256f;
        mu[84] = 0.853866f;
        mu[85] = 0.853866f;
        mu[86] = 0.853866f;
        mu[87] = 0.920768f;
        mu[88] = 0.920768f;
        mu[89] = 0.983128f;

        for(int i = 90; i < 180; i++)
            mu[i] = mu[i-90];
        for(int i = 180; i < 360; i++)
            mu[i] = mu[i-180];

        eta[0] = -0.129345f;
        eta[1] = -0.129345f;
        eta[2] = -0.368044f;
        eta[3] = -0.129345f;
        eta[4] = -0.368044f;
        eta[5] = -0.504165f;
        eta[6] = -0.129345f;
        eta[7] = -0.368044f;
        eta[8] = -0.504165f;
        eta[9] = -0.610663f;
        eta[10] = -0.129345f;
        eta[11] = -0.368044f;
        eta[12] = -0.504165f;
        eta[13] = -0.610663f;
        eta[14] = -0.701167f;
        eta[15] = -0.129345f;
        eta[16] = -0.368044f;
        eta[17] = -0.504165f;
        eta[18] = -0.610663f;
        eta[19] = -0.701167f;
        eta[20] = -0.781256f;
        eta[21] = -0.129345f;
        eta[22] = -0.368044f;
        eta[23] = -0.504165f;
        eta[24] = -0.610663f;
        eta[25] = -0.701167f;
        eta[26] = -0.781256f;
        eta[27] = -0.853866f;
        eta[28] = -0.129345f;
        eta[29] = -0.368044f;
        eta[30] = -0.504165f;
        eta[31] = -0.610663f;
        eta[32] = -0.701167f;
        eta[33] = -0.781256f;
        eta[34] = -0.853866f;
        eta[35] = -0.920768f;
        eta[36] = -0.129345f;
        eta[37] = -0.368044f;
        eta[38] = -0.504165f;
        eta[39] = -0.610663f;
        eta[40] = -0.701167f;
        eta[41] = -0.781256f;
        eta[42] = -0.853866f;
        eta[43] = -0.920768f;
        eta[44] = -0.983128f;
        eta[45] = -0.983128f;
        eta[46] = -0.920768f;
        eta[47] = -0.853866f;
        eta[48] = -0.781256f;
        eta[49] = -0.701167f;
        eta[50] = -0.610663f;
        eta[51] = -0.504165f;
        eta[52] = -0.368044f;
        eta[53] = -0.129345f;
        eta[54] = -0.920768f;
        eta[55] = -0.853866f;
        eta[56] = -0.781256f;
        eta[57] = -0.701167f;
        eta[58] = -0.610663f;
        eta[59] = -0.504165f;
        eta[60] = -0.368044f;
        eta[61] = -0.129345f;
        eta[62] = -0.853866f;
        eta[63] = -0.781256f;
        eta[64] = -0.701167f;
        eta[65] = -0.610663f;
        eta[66] = -0.504165f;
        eta[67] = -0.368044f;
        eta[68] = -0.129345f;
        eta[69] = -0.781256f;
        eta[70] = -0.701167f;
        eta[71] = -0.610663f;
        eta[72] = -0.504165f;
        eta[73] = -0.368044f;
        eta[74] = -0.129345f;
        eta[75] = -0.701167f;
        eta[76] = -0.610663f;
        eta[77] = -0.504165f;
        eta[78] = -0.368044f;
        eta[79] = -0.129345f;
        eta[80] = -0.610663f;
        eta[81] = -0.504165f;
        eta[82] = -0.368044f;
        eta[83] = -0.129345f;
        eta[84] = -0.504165f;
        eta[85] = -0.368044f;
        eta[86] = -0.129345f;
        eta[87] = -0.368044f;
        eta[88] = -0.129345f;
        eta[89] = -0.129345f;

        for(int i = 90; i < 180; i++)
            eta[i] = eta[i-90];
        for(int i = 180; i < 360; i++)
            eta[i] = -eta[i-180];

        for(int i = 0; i < 90; i++)
            zi[i] = -sqrt(1 - mu[i]*mu[i] - eta[i]*eta[i]);
        for(int i = 90; i < 180; i++)
            zi[i] = -zi[i-90];
        for(int i = 180; i < 360; i++)
            zi[i] = zi[i-180];

        wt[0] = 0.0422646f/8.0f;
        wt[1] = 0.0376127f/8.0f;
        wt[2] = 0.0376127f/8.0f;
        wt[3] = 0.0066907f/8.0f;
        wt[4] = 0.0423662f/8.0f;
        wt[5] = 0.0066907f/8.0f;
        wt[6] = 0.0391919f/8.0f;
        wt[7] = 0.0092396f/8.0f;
        wt[8] = 0.0092396f/8.0f;
        wt[9] = 0.0391919f/8.0f;
        wt[10] = 0.0042550f/8.0f;
        wt[11] = 0.0156648f/8.0f;
        wt[12] = 0.0136576f/8.0f;
        wt[13] = 0.0156648f/8.0f;
        wt[14] = 0.0042550f/8.0f;
        wt[15] = 0.0391919f/8.0f;
        wt[16] = 0.0156648f/8.0f;
        wt[17] = 0.0139903f/8.0f;
        wt[18] = 0.0139903f/8.0f;
        wt[19] = 0.0156648f/8.0f;
        wt[20] = 0.0391919f/8.0f;
        wt[21] = 0.0066907f/8.0f;
        wt[22] = 0.0092396f/8.0f;
        wt[23] = 0.0136576f/8.0f;
        wt[24] = 0.0139903f/8.0f;
        wt[25] = 0.0136576f/8.0f;
        wt[26] = 0.0092396f/8.0f;
        wt[27] = 0.0066907f/8.0f;
        wt[28] = 0.0376127f/8.0f;
        wt[29] = 0.0423662f/8.0f;
        wt[30] = 0.0092396f/8.0f;
        wt[31] = 0.0156648f/8.0f;
        wt[32] = 0.0156648f/8.0f;
        wt[33] = 0.0092396f/8.0f;
        wt[34] = 0.0423662f/8.0f;
        wt[35] = 0.0376127f/8.0f;
        wt[36] = 0.0422646f/8.0f;
        wt[37] = 0.0376127f/8.0f;
        wt[38] = 0.0066907f/8.0f;
        wt[39] = 0.0391919f/8.0f;
        wt[40] = 0.0042550f/8.0f;
        wt[41] = 0.0391919f/8.0f;
        wt[42] = 0.0066907f/8.0f;
        wt[43] = 0.0376127f/8.0f;
        wt[44] = 0.0422646f/8.0f;
        wt[45] = 0.0422646f/8.0f;
        wt[46] = 0.0376127f/8.0f;
        wt[47] = 0.0066907f/8.0f;
        wt[48] = 0.0391919f/8.0f;
        wt[49] = 0.0042550f/8.0f;
        wt[50] = 0.0391919f/8.0f;
        wt[51] = 0.0066907f/8.0f;
        wt[52] = 0.0376127f/8.0f;
        wt[53] = 0.0422646f/8.0f;
        wt[54] = 0.0376127f/8.0f;
        wt[55] = 0.0423662f/8.0f;
        wt[56] = 0.0092396f/8.0f;
        wt[57] = 0.0156648f/8.0f;
        wt[58] = 0.0156648f/8.0f;
        wt[59] = 0.0092396f/8.0f;
        wt[60] = 0.0423662f/8.0f;
        wt[61] = 0.0376127f/8.0f;
        wt[62] = 0.0066907f/8.0f;
        wt[63] = 0.0092396f/8.0f;
        wt[64] = 0.0136576f/8.0f;
        wt[65] = 0.0139903f/8.0f;
        wt[66] = 0.0136576f/8.0f;
        wt[67] = 0.0092396f/8.0f;
        wt[68] = 0.0066907f/8.0f;
        wt[69] = 0.0391919f/8.0f;
        wt[70] = 0.0156648f/8.0f;
        wt[71] = 0.0139903f/8.0f;
        wt[72] = 0.0139903f/8.0f;
        wt[73] = 0.0156648f/8.0f;
        wt[74] = 0.0391919f/8.0f;
        wt[75] = 0.0042550f/8.0f;
        wt[76] = 0.0156648f/8.0f;
        wt[77] = 0.0136576f/8.0f;
        wt[78] = 0.0156648f/8.0f;
        wt[79] = 0.0042550f/8.0f;
        wt[80] = 0.0391919f/8.0f;
        wt[81] = 0.0092396f/8.0f;
        wt[82] = 0.0092396f/8.0f;
        wt[83] = 0.0391919f/8.0f;
        wt[84] = 0.0066907f/8.0f;
        wt[85] = 0.0423662f/8.0f;
        wt[86] = 0.0066907f/8.0f;
        wt[87] = 0.0376127f/8.0f;
        wt[88] = 0.0376127f/8.0f;
        wt[89] = 0.0422646f/8.0f;

        for(int i = 90; i < 180; i++)
            wt[i] = wt[i-90];
        for(int i = 180; i < 360; i++)
            wt[i] = wt[i-180];
    }
    else if(sn == 20)   //Fixme! add one more quad
    {
        mu[0] = -0.9853475f;
        mu[1] = -0.9298639f;
        mu[2] = -0.9298639f;
        mu[3] = -0.8708526f;
        mu[4] = -0.8708526f;
        mu[5] = -0.8708526f;
        mu[6] = -0.8075404f;
        mu[7] = -0.8075404f;
        mu[8] = -0.8075404f;
        mu[9] = -0.8075404f;
        mu[10] = -0.7388226f;
        mu[11] = -0.7388226f;
        mu[12] = -0.7388226f;
        mu[13] = -0.7388226f;
        mu[14] = -0.7388226f;
        mu[15] = -0.6630204f;
        mu[16] = -0.6630204f;
        mu[17] = -0.6630204f;
        mu[18] = -0.6630204f;
        mu[19] = -0.6630204f;
        mu[20] = -0.6630204f;
        mu[21] = -0.5773503f;
        mu[22] = -0.5773503f;
        mu[23] = -0.5773503f;
        mu[24] = -0.5773503f;
        mu[25] = -0.5773503f;
        mu[26] = -0.5773503f;
        mu[27] = -0.5773503f;
        mu[28] = -0.4765193f;
        mu[29] = -0.4765193f;
        mu[30] = -0.4765193f;
        mu[31] = -0.4765193f;
        mu[32] = -0.4765193f;
        mu[33] = -0.4765193f;
        mu[34] = -0.4765193f;
        mu[35] = -0.4765193f;
        mu[36] = -0.3475743f;
        mu[37] = -0.3475743f;
        mu[38] = -0.3475743f;
        mu[39] = -0.3475743f;
        mu[40] = -0.3475743f;
        mu[41] = -0.3475743f;
        mu[42] = -0.3475743f;
        mu[43] = -0.3475743f;
        mu[44] = -0.3475743f;
        mu[45] = -0.1206033f;
        mu[46] = -0.1206033f;
        mu[47] = -0.1206033f;
        mu[48] = -0.1206033f;
        mu[49] = -0.1206033f;
        mu[50] = -0.1206033f;
        mu[51] = -0.1206033f;
        mu[52] = -0.1206033f;
        mu[53] = -0.1206033f;
        mu[54] = -0.1206033f;
        mu[55] = 0.1206033f;
        mu[56] = 0.1206033f;
        mu[57] = 0.1206033f;
        mu[58] = 0.1206033f;
        mu[59] = 0.1206033f;
        mu[60] = 0.1206033f;
        mu[61] = 0.1206033f;
        mu[62] = 0.1206033f;
        mu[63] = 0.1206033f;
        mu[64] = 0.1206033f;
        mu[65] = 0.3475743f;
        mu[66] = 0.3475743f;
        mu[67] = 0.3475743f;
        mu[68] = 0.3475743f;
        mu[69] = 0.3475743f;
        mu[70] = 0.3475743f;
        mu[71] = 0.3475743f;
        mu[72] = 0.3475743f;
        mu[73] = 0.3475743f;
        mu[74] = 0.4765193f;
        mu[75] = 0.4765193f;
        mu[76] = 0.4765193f;
        mu[77] = 0.4765193f;
        mu[78] = 0.4765193f;
        mu[79] = 0.4765193f;
        mu[80] = 0.4765193f;
        mu[81] = 0.4765193f;
        mu[82] = 0.5773503f;
        mu[83] = 0.5773503f;
        mu[84] = 0.5773503f;
        mu[85] = 0.5773503f;
        mu[86] = 0.5773503f;
        mu[87] = 0.5773503f;
        mu[88] = 0.5773503f;
        mu[89] = 0.6630204f;
        mu[90] = 0.6630204f;
        mu[91] = 0.6630204f;
        mu[92] = 0.6630204f;
        mu[93] = 0.6630204f;
        mu[94] = 0.6630204f;
        mu[95] = 0.7388226f;
        mu[96] = 0.7388226f;
        mu[97] = 0.7388226f;
        mu[98] = 0.7388226f;
        mu[99] = 0.7388226f;
        mu[100] = 0.8075404f;
        mu[101] = 0.8075404f;
        mu[102] = 0.8075404f;
        mu[103] = 0.8075404f;
        mu[104] = 0.8708526f;
        mu[105] = 0.8708526f;
        mu[106] = 0.8708526f;
        mu[107] = 0.9298639f;
        mu[108] = 0.9298639f;
        mu[109] = 0.9853475f;

        for(int i = 110; i < 220; i++)
            mu[i] = mu[i-110];
        for(int i = 220; i < 440; i++)
            mu[i] = mu[i-220];

        eta[0] = -0.1206033f;
        eta[1] = -0.1206033f;
        eta[2] = -0.3475743f;
        eta[3] = -0.1206033f;
        eta[4] = -0.3475743f;
        eta[5] = -0.4765193f;
        eta[6] = -0.1206033f;
        eta[7] = -0.3475743f;
        eta[8] = -0.4765193f;
        eta[9] = -0.5773503f;
        eta[10] = -0.1206033f;
        eta[11] = -0.3475743f;
        eta[12] = -0.4765193f;
        eta[13] = -0.5773503f;
        eta[14] = -0.6630204f;
        eta[15] = -0.1206033f;
        eta[16] = -0.3475743f;
        eta[17] = -0.4765193f;
        eta[18] = -0.5773503f;
        eta[19] = -0.6630204f;
        eta[20] = -0.7388226f;
        eta[21] = -0.1206033f;
        eta[22] = -0.3475743f;
        eta[23] = -0.4765193f;
        eta[24] = -0.5773503f;
        eta[25] = -0.6630204f;
        eta[26] = -0.7388226f;
        eta[27] = -0.8075404f;
        eta[28] = -0.1206033f;
        eta[29] = -0.3475743f;
        eta[30] = -0.4765193f;
        eta[31] = -0.5773503f;
        eta[32] = -0.6630204f;
        eta[33] = -0.7388226f;
        eta[34] = -0.8075404f;
        eta[35] = -0.8708526f;
        eta[36] = -0.1206033f;
        eta[37] = -0.3475743f;
        eta[38] = -0.4765193f;
        eta[39] = -0.5773503f;
        eta[40] = -0.6630204f;
        eta[41] = -0.7388226f;
        eta[42] = -0.8075404f;
        eta[43] = -0.8708526f;
        eta[44] = -0.9298639f;
        eta[45] = -0.1206033f;
        eta[46] = -0.3475743f;
        eta[47] = -0.4765193f;
        eta[48] = -0.5773503f;
        eta[49] = -0.6630204f;
        eta[50] = -0.7388226f;
        eta[51] = -0.8075404f;
        eta[52] = -0.8708526f;
        eta[53] = -0.9298639f;
        eta[54] = -0.9853475f;
        eta[55] = -0.9853475f;
        eta[56] = -0.9298639f;
        eta[57] = -0.8708526f;
        eta[58] = -0.8075404f;
        eta[59] = -0.7388226f;
        eta[60] = -0.6630204f;
        eta[61] = -0.5773503f;
        eta[62] = -0.4765193f;
        eta[63] = -0.3475743f;
        eta[64] = -0.1206033f;
        eta[65] = -0.9298639f;
        eta[66] = -0.8708526f;
        eta[67] = -0.8075404f;
        eta[68] = -0.7388226f;
        eta[69] = -0.6630204f;
        eta[70] = -0.5773503f;
        eta[71] = -0.4765193f;
        eta[72] = -0.3475743f;
        eta[73] = -0.1206033f;
        eta[74] = -0.8708526f;
        eta[75] = -0.8075404f;
        eta[76] = -0.7388226f;
        eta[77] = -0.6630204f;
        eta[78] = -0.5773503f;
        eta[79] = -0.4765193f;
        eta[80] = -0.3475743f;
        eta[81] = -0.1206033f;
        eta[82] = -0.8075404f;
        eta[83] = -0.7388226f;
        eta[84] = -0.6630204f;
        eta[85] = -0.5773503f;
        eta[86] = -0.4765193f;
        eta[87] = -0.3475743f;
        eta[88] = -0.1206033f;
        eta[89] = -0.7388226f;
        eta[90] = -0.6630204f;
        eta[91] = -0.5773503f;
        eta[92] = -0.4765193f;
        eta[93] = -0.3475743f;
        eta[94] = -0.1206033f;
        eta[95] = -0.6630204f;
        eta[96] = -0.5773503f;
        eta[97] = -0.4765193f;
        eta[98] = -0.3475743f;
        eta[99] = -0.1206033f;
        eta[100] = -0.5773503f;
        eta[101] = -0.4765193f;
        eta[102] = -0.3475743f;
        eta[103] = -0.1206033f;
        eta[104] = -0.4765193f;
        eta[105] = -0.3475743f;
        eta[106] = -0.1206033f;
        eta[107] = -0.3475743f;
        eta[108] = -0.1206033f;
        eta[109] = -0.1206033f;

        for(int i = 110; i < 220; i++)
            eta[i] = eta[i-110];
        for(int i = 220; i < 440; i++)
            eta[i] = -eta[i-220];

        for(int i = 0; i < 110; i++)
            zi[i] = -sqrt(1 - mu[i]*mu[i] - eta[i]*eta[i]);
        for(int i = 110; i < 220; i++)
            zi[i] = -zi[i-110];
        for(int i = 220; i < 440; i++)
            zi[i] = zi[i-220];

        wt[0] = 0.037021048f/8.0f;
        wt[1] = 0.033284217f/8.0f;
        wt[2] = 0.033284217f/8.0f;
        wt[3] = 0.013967015f/8.0f;
        wt[4] = 0.026216671f/8.0f;
        wt[5] = 0.013967015f/8.0f;
        wt[6] = 0.029085133f/8.0f;
        wt[7] = 0.0022875394f/8.0f;
        wt[8] = 0.0022875394f/8.0f;
        wt[9] = 0.029085133f/8.0f;
        wt[10] = 0.0062319301f/8.0f;
        wt[11] = 0.036399130f/8.0f;
        wt[12] = 0.0089905960f/8.0f;
        wt[13] = 0.036399130f/8.0f;
        wt[14] = 0.0062319301f/8.0f;
        wt[15] = 0.0062319301f/8.0f;
        wt[16] = 0.0089905960f/8.0f;
        wt[17] = 0.0029760692f/8.0f;
        wt[18] = 0.0029760692f/8.0f;
        wt[19] = 0.0089905960f/8.0f;
        wt[20] = 0.0062319301f/8.0f;
        wt[21] = 0.029085133f/8.0f;
        wt[22] = 0.036399130f/8.0f;
        wt[23] = 0.0029760692f/8.0f;
        wt[24] = 0.010957079f/8.0f;
        wt[25] = 0.0029760692f/8.0f;
        wt[26] = 0.036399130f/8.0f;
        wt[27] = 0.029085133f/8.0f;
        wt[28] = 0.013967015f/8.0f;
        wt[29] = 0.0022875394f/8.0f;
        wt[30] = 0.0089905960f/8.0f;
        wt[31] = 0.0029760692f/8.0f;
        wt[32] = 0.0029760692f/8.0f;
        wt[33] = 0.0089905960f/8.0f;
        wt[34] = 0.0022875394f/8.0f;
        wt[35] = 0.013967015f/8.0f;
        wt[36] = 0.033284217f/8.0f;
        wt[37] = 0.026216671f/8.0f;
        wt[38] = 0.0022875394f/8.0f;
        wt[39] = 0.036399130f/8.0f;
        wt[40] = 0.0089905960f/8.0f;
        wt[41] = 0.036399130f/8.0f;
        wt[42] = 0.0022875394f/8.0f;
        wt[43] = 0.026216671f/8.0f;
        wt[44] = 0.033284217f/8.0f;
        wt[45] = 0.037021048f/8.0f;
        wt[46] = 0.033284217f/8.0f;
        wt[47] = 0.013967015f/8.0f;
        wt[48] = 0.029085133f/8.0f;
        wt[49] = 0.0062319301f/8.0f;
        wt[50] = 0.0062319301f/8.0f;
        wt[51] = 0.029085133f/8.0f;
        wt[52] = 0.013967015f/8.0f;
        wt[53] = 0.033284217f/8.0f;
        wt[54] = 0.037021048f/8.0f;
        wt[55] = 0.037021048f/8.0f;
        wt[56] = 0.033284217f/8.0f;
        wt[57] = 0.013967015f/8.0f;
        wt[58] = 0.029085133f/8.0f;
        wt[59] = 0.0062319301f/8.0f;
        wt[60] = 0.0062319301f/8.0f;
        wt[61] = 0.029085133f/8.0f;
        wt[62] = 0.013967015f/8.0f;
        wt[63] = 0.033284217f/8.0f;
        wt[64] = 0.037021048f/8.0f;
        wt[65] = 0.033284217f/8.0f;
        wt[66] = 0.026216671f/8.0f;
        wt[67] = 0.0022875394f/8.0f;
        wt[68] = 0.036399130f/8.0f;
        wt[69] = 0.0089905960f/8.0f;
        wt[70] = 0.036399130f/8.0f;
        wt[71] = 0.0022875394f/8.0f;
        wt[72] = 0.026216671f/8.0f;
        wt[73] = 0.033284217f/8.0f;
        wt[74] = 0.013967015f/8.0f;
        wt[75] = 0.0022875394f/8.0f;
        wt[76] = 0.0089905960f/8.0f;
        wt[77] = 0.0029760692f/8.0f;
        wt[78] = 0.0029760692f/8.0f;
        wt[79] = 0.0089905960f/8.0f;
        wt[80] = 0.0022875394f/8.0f;
        wt[81] = 0.013967015f/8.0f;
        wt[82] = 0.029085133f/8.0f;
        wt[83] = 0.036399130f/8.0f;
        wt[84] = 0.0029760692f/8.0f;
        wt[85] = 0.010957079f/8.0f;
        wt[86] = 0.0029760692f/8.0f;
        wt[87] = 0.036399130f/8.0f;
        wt[88] = 0.029085133f/8.0f;
        wt[89] = 0.0062319301f/8.0f;
        wt[90] = 0.0089905960f/8.0f;
        wt[91] = 0.0029760692f/8.0f;
        wt[92] = 0.0029760692f/8.0f;
        wt[93] = 0.0089905960f/8.0f;
        wt[94] = 0.0062319301f/8.0f;
        wt[95] = 0.0062319301f/8.0f;
        wt[96] = 0.036399130f/8.0f;
        wt[97] = 0.0089905960f/8.0f;
        wt[98] = 0.036399130f/8.0f;
        wt[99] = 0.0062319301f/8.0f;
        wt[100] = 0.029085133f/8.0f;
        wt[101] = 0.0022875394f/8.0f;
        wt[102] = 0.0022875394f/8.0f;
        wt[103] = 0.029085133f/8.0f;
        wt[104] = 0.013967015f/8.0f;
        wt[105] = 0.026216671f/8.0f;
        wt[106] = 0.013967015f/8.0f;
        wt[107] = 0.033284217f/8.0f;
        wt[108] = 0.033284217f/8.0f;
        wt[109] = 0.037021048f/8.0f;

        for(int i = 110; i < 220; i++)
            wt[i] = wt[i-110];
        for(int i = 220; i < 440; i++)
            wt[i] = wt[i-220];
    }
    // For Sn>20, Legendre-Chebyshev quadrature used. Polar angle is the angle with x axis.
    // mu levels or polar angles are roots of Legendre polynomials.
    // Weight of mu level is the from Gauss-Legendre quadrature.
    // Azimuthal angle at each mu level is the roots of first-kind Chebyshev polynomials.
    // Weight of each direction at each mu level is equally divided from the mu level weight.
    else if(sn > 20)
    {
        // Read in mu level - positive roots and weights of Legendre polynomial
        Legendre legentest;
        legentest.Pn_roots_weights(sn);
        const std::vector<double> & level_weight = legentest.getWeight();
        const std::vector<double> & mulevel = legentest.getRoot();

        for(int i = 0; i < sn; i++)
        {
            std::cout << "root_" << i << " = " << mulevel[i] << std::endl;

        }
        for(int i = 0; i < sn; i++)
        {
            std::cout << "wt_" << i << " = " << level_weight[i] << std::endl;

        }

        int ind = 0;

        for(int ioct = 0; ioct < 8; ioct++)  // Loop over 8 octant
        {
            std::cout << "Octant = " << ioct+1 << std::endl;

            for(int i = 1; i <= sn/2; i++) // Loop with mu level
            {
                for(int j = 1; j <= i; j++)   // Loop over directions at each mu level
                {
                    //std::cout << "Mu level = " << i << std::endl;
                    //std::cout << "Direction index = " << ind << std::endl;
                    float phi_ij = (2*j-1) * M_PI_2 / (2*i);
                    if(ioct < 4)
                    {
                        mu[ind] = mulevel[i-1];
                        if(ioct < 2)
                        {
                            eta[ind] = sqrt(1-mu[ind]*mu[ind])*cos(phi_ij);
                            if(ioct == 0)
                                zi[ind] = sqrt(1 - mu[ind]*mu[ind] - eta[ind]*eta[ind]);   //+++
                            else
                                zi[ind] = -sqrt(1 - mu[ind]*mu[ind] - eta[ind]*eta[ind]);  //++-
                        }
                        else if(ioct < 4)
                        {
                            eta[ind] = -sqrt(1-mu[ind]*mu[ind])*cos(phi_ij);
                            if(ioct == 2)
                                zi[ind] = sqrt(1 - mu[ind]*mu[ind] - eta[ind]*eta[ind]);   //+-+
                            else
                                zi[ind] = -sqrt(1 - mu[ind]*mu[ind] - eta[ind]*eta[ind]);  //+--
                        }
                    }
                    else if(ioct < 8)
                    {
                        mu[ind] = -mulevel[i-1];
                        if(ioct < 6)
                        {
                            eta[ind] = sqrt(1-mu[ind]*mu[ind])*cos(phi_ij);
                            if(ioct == 4)
                                zi[ind] = sqrt(1 - mu[ind]*mu[ind] - eta[ind]*eta[ind]);   //-++
                            else
                                zi[ind] = -sqrt(1 - mu[ind]*mu[ind] - eta[ind]*eta[ind]);  //-+-
                        }
                        else if(ioct < 8)
                        {
                            eta[ind] = -sqrt(1-mu[ind]*mu[ind])*cos(phi_ij);
                            if(ioct == 6)
                                zi[ind] = sqrt(1 - mu[ind]*mu[ind] - eta[ind]*eta[ind]);   //--+
                            else
                                zi[ind] = -sqrt(1 - mu[ind]*mu[ind] - eta[ind]*eta[ind]);  //---
                        }
                    }

                    wt[ind] = level_weight[i-1] / i / 8.0; // Normalize weight
                    //std::cout << "Phi_" << i << j <<" = " << phi_ij << std::endl;
                    //std::cout << "mu__" << i << j <<" = " << mu[ind] << std::endl;
                    //std::cout << "eta__" << i << j <<" = " << eta[ind] << std::endl;
                    //std::cout << "zi__" << i << j <<" = " << zi[ind] << std::endl;
                    //std::cout << "w__" << i << j <<" = " << wt[ind] << std::endl;
                    ind++;
                }
            }
        }

    }
    else
    {
        std::cout << "ERROR: Unknown quadrature!! Sn = " << sn << std::endl;

    }

    sortIntoOctants();
}

void Quadrature::sortIntoOctants()
{
    std::vector<float> tmu = mu;
    std::vector<float> txi = zi;
    std::vector<float> teta = eta;
    std::vector<float> twt = wt;
    std::vector<int> transposeRecord;
    transposeRecord.resize(angleCount(), -1);

    std::vector<int> octPtrs;
    octPtrs.resize(8, 0);

    for(unsigned int ia = 0; ia < angleCount(); ia++)
    {
        /*
        int octant = 0;
        if(mu[ia] < 0)
            octant += 4;
        if(zi[ia] < 0)
            octant += 2;
        if(eta[ia] < 0)
            octant += 1;
        */

        int octant = (mu[ia] > 0 ? 0 : 4) + (zi[ia] > 0 ? 0 : 2) +
                       (eta[ia] > 0 ? 0 : 1);

        int iaNew = octant*angleCount()/8 + octPtrs[octant];

        tmu[iaNew] = mu[ia];
        txi[iaNew] = zi[ia];
        teta[iaNew] = eta[ia];
        twt[iaNew] = wt[ia];
        transposeRecord[iaNew] = ia;
        octPtrs[octant]++;
    }

    mu = tmu;
    zi = txi;
    eta = teta;
    wt = twt;
}
